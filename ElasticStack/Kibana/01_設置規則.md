## 概述


<br/>

<br/>


## 需要先配置
1. ES 需要先配置 [Basic Security](../Elasticsearch/06_設置basic_security.md)

2. ES API key 服務需要啟用

3. Kibana 需要額外配置密鑰


<br/>

<br/>


## 配置步驟

1. ES 開啟 `Basic Security` 和 `API Keys 服務`。

    ```yml
    # elasticsearch.yml
    
    # Basic Security
    xpack.security.enabled: true
    xpack.security.transport.ssl.enabled: true
    xpack.license.self_generated.type: basic

    # API Keys Service
    xpack.security.authc.api_key.enabled: true
    ```

2. Kibana 有自帶 CLI 工具，可以產生一組密鑰

    ```sh
    /usr/share/kibana/bin/kibana-encryption-keys generate
    ```

3. 配置到 Kibana.yml

    ```yml
    # Basic Security，用來與 ES 連接
    elasticsearch.username: "kibana_system"
    elasticsearch.password: "@WSX3edc"

    # 額外配置密鑰
    xpack.encryptedSavedObjects.encryptionKey: b65fdbdd274392b8bf4e09e488d5e9b6
    #xpack.reporting.encryptionKey: 57e5cfe65ea780953626331b4b070654
    #xpack.security.encryptionKey: 93ecc69471c97eb69496a45b44a43dd0
    ```