## 為什麼要用雲平台

1. 環境統一

2. 按需收費

3. 即開即用

4. 穩定性強

<br/>

<br/>

## 公有雲 v.s. 私有雲

公有雲: 由第三方服務提供商擁有 (如AWS、Azure、GCP)。

1. 成本低

2. 無須維護

3. 幾乎無限制的可擴展性(依照業務滿足需求)

4. 高可靠性

---

私有雲: 由單個組織或企業擁有，部署在本地或專用數據中心。

1. 初期成本高

2. 需自行維護

3. 可擴展性有限，受硬件和內部資源的限制。

4. 由組織內部或外包的IT團隊負責管理和維護。

<br/>

<br/>

## K8S 解決了什麼問題

簡單來說，K8S 就是分佈式系統的管理框架。

1. 服務發現、負載均衡

2. 存儲編排: 

    - 當啟動服務A時，服務A會向K8S要存儲空間，當要刪除服務A時，會一併把關聯的存儲空間刪除，不會有遺留的資料。

3. 自動化部署、Rollback

    - 支持部署後回到上一個版本。

4. 自動化完成裝箱計算

5. 自我修復

    - 防止微服務的雪崩效應

6. 密鑰與配置管理

    - 儲存敏感資訊

    - 儲存配置，有點類似 spring cloud config

<br/>

<br/>

## 架構

<img src='../_image/2233058-20210805105202343-1017707449.png'>


<br/>

* 左邊是 master 節點，右邊是其他 worker 節點。

    * Pod 可以存在於 master 或 worker node
    
    * Master 既可以作為 master node，也可以成為 worker node。

* Master node

    1. 集群管理與控制:

        * 資源調度：將應用（Pod）調度到合適的 Worker Node 上。
        
        * 監控健康狀態：監控節點、Pod 和其他資源的狀態，確保集群運行正常。

        * 配置管理：管理用戶提交的 YAML 或 JSON 文件中定義的資源（如 Pod、Service 等）。

    2. API 請求處理(`kube-apiserver`) : 所有來自用戶或集群內部的 API 請求（例如通過 kubectl 提交的操作）都會經過 Master Node 的 kube-apiserver 。

        * 驗證請求（身份驗證與授權）。

        * 處理並將操作寫入 etcd（集群的數據存儲）。

        * 分發操作給其他組件執行，例如調度器或控制器。

    3. 資源調度(`kube-scheduler`) : 將未綁定的 Pod 調度到合適的 Worker Node 上 。

        * 根據資源需求（如 CPU、內存）。

        * 根據策略（如親和性、反親和性）。

    4. 集群數據存儲(`etcd`) : etcd 是分佈式數據存儲，存儲了 Kubernetes 集群的所有狀態和配置信息：

        * 所有資源對象（Pod、Service、Deployment 等）的描述。

        * 集群的運行狀態。

    5. 控制器運行(`kube-controller-manager`)

        * Replication Controller：確保指定數量的 Pod 運行。

        * Node Controller：監控節點是否正常。

        * Endpoint Controller：更新 Service 與 Pod 的關聯。

    * 包含的組件有

        1. kube-apiserver

        2. kube-scheduler

        3. etcd

        4. kube-controller-manager

        5. cloud-controller-manager

* Worker node

    * 包含的組件有

        1. kubelet

        2. kube-proxy

        3. container runtime


--- 

* 附加組件 (可自定義是否要安裝)

    1. Kube-dns

    2. Ingress controller

    3. Heapster

    4. Dashboard

    5. Federation

    6. Fluentd-elasticsearch

<br/>

<br/>